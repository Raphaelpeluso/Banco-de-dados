CREATE TABLE IF NOT EXISTS FORNECEDOR(
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOME VARCHAR2(100) NOT NULL,
    CNPJ VARCHAR2(14) NOT NULL UNIQUE,
    CONTATO NUMBER(11) NOT NULL
);

CREATE TABLE IF NOT EXISTS MATERIAL(
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOME VARCHAR2(50) NOT NULL,
    UNIDADE VARCHAR2(20) NOT NULL,
    FORNECEDOR_ID NUMBER REFERENCES FORNECEDOR(ID)
);

CREATE TABLE IF NOT EXISTS RECEITA(
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    TIPO_CONCRETO VARCHAR2(50) NOT NULL,
    DESCRICAO VARCHAR2(255)
);

CREATE TABLE IF NOT EXISTS RECEITA_MATERIAL(
    RECEITA_ID NUMBER NOT NULL REFERENCES RECEITA(ID),
    MATERIAL_ID NUMBER NOT NULL REFERENCES MATERIAL(ID),
    PROPORCAO_KG NUMBER(6) NOT NULL CHECK (PROPORCAO_KG > 0),
    CONSTRAINT FK_RECEITA_MATERIAL UNIQUE (RECEITA_ID, MATERIAL_ID)
);

CREATE TABLE IF NOT EXISTS VEICULO(
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    PLACA VARCHAR2(10) NOT NULL UNIQUE,
    CAPACIDADE_TON NUMBER(2) NOT NULL CHECK (CAPACIDADE > 0),
    MOTORISTA VARCHAR2(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS LOTE(
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    DATA_PRODUCAO DATE NOT NULL,
    QUANTIDADE_TON NUMBER(2) NOT NULL CHECK (QUANTIDADE_TON > 0),
    STATUS VARCHAR2(30) NOT NULL,
    RECEITA_ID NUMBER NOT NULL REFERENCES RECEITA(ID),
    VEICULO_ID NUMBER NOT NULL REFERENCES VEICULO(ID)
);

CREATE TABLE IF NOT EXISTS FUNCIONARIO(
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOME VARCHAR2(100) NOT NULL,
    CARGO VARCHAR2(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS LOTE_FUNCIONARIO(
    LOTE_ID NUMBER REFERENCES LOTE(ID),
    FUNCIONARIO_ID NUMBER NOT NULL REFERENCES FUNCIONARIO(ID),
    CONSTRAINT FK_LOTE_FUNCIONARIO UNIQUE (LOTE_ID, FUNCIONARIO_ID) 
);

CREATE TABLE IF NOT EXISTS CLIENTE(
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOME VARCHAR2(100) NOT NULL,
    CNPJ_CPF VARCHAR2(14) UNIQUE NOT NULL,
    CONTATO NUMBER(11) NOT NULL
);

CREATE TABLE VENDA(
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    LOTE_ID NUMBER NOT NULL REFERENCES LOTE(ID),
    CLIENTE_ID NUMBER NOT NULL REFERENCES CLIENTE(ID),
    VALOR_TOTAL DECIMAL(10) NOT NULL CHECK (VALOR_TOTAL > 0)
);
