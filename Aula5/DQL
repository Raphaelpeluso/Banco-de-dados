CREATE TABLE IF NOT EXISTS VENDAS(
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    PRODUTO VARCHAR2(100) NOT NULL,
    CATEGORIA VARCHAR2(50) NOT NULL,
    VALOR NUMBER(10,2) NOT NULL CHECK (VALOR > 0),
    DATA_VENDA DATE DEFAULT SYSDATE,
    VENDEDOR VARCHAR2(100) NOT NULL
);

INSERT INTO VENDAS (produto, categoria, valor, data_venda, vendedor) 
VALUES 
    ('Notebook Dell', 'Eletrônicos', 4500.00, DATE '2025-04-01', 'Carlos'),
    ('Mouse Gamer', 'Acessórios', 150.00, DATE '2025-04-01', 'Ana'),
    ('Teclado Mecânico', 'Acessórios', 300.00, DATE '2025-04-02', 'Carlos'),
    ('Monitor 24"', 'Eletrônicos', 1200.00, DATE '2025-04-02', 'Bruna'),
    ('Fone Bluetooth', 'Acessórios', 200.00, DATE '2025-04-03', 'Ana'),
    ('Notebook HP', 'Eletrônicos', 4000.00, DATE '2025-04-03', 'Carlos'),
    ('Webcam HD', 'Acessórios', 180.00, DATE '2025-04-04', 'Bruna'),
    ('Carregador Portátil', 'Acessórios', 120.00, DATE '2025-04-04', 'Ana'),
    ('SSD 1TB', 'Componentes', 500.00, DATE '2025-04-05', 'Carlos'),
    ('Cabo HDMI', 'Acessórios', 50.00, DATE '2025-04-05', 'Bruna');

SELECT COUNT(*) 
FROM VENDAS;

SELECT DISTINCT PRODUTO 
FROM VENDAS;

SELECT PRODUTO, CATEGORIA 
FROM VENDAS 
WHERE CATEGORIA = 'Acessórios';

SELECT COUNT(CATEGORIA) 
FROM VENDAS 
WHERE CATEGORIA = 'Acessórios';

SELECT PRODUTO, VALOR, DATA_VENDA 
FROM VENDAS 
WHERE VALOR BETWEEN 200 AND 500;

SELECT produto, valor, categoria
FROM VENDAS
WHERE produto LIKE '%Notebook%';

SELECT SUM(valor) AS total_geral
FROM VENDAS WHERE CATEGORIA = 'Acessórios';

-- Relatório 10: Estatísticas de preços
SELECT
    AVG(valor) AS media_preco,
    MIN(valor) AS menor_preco,
    MAX(valor) AS maior_preco,
    COUNT(*)   AS total_vendas
FROM VENDAS;

SELECT  MIN(DATA_VENDA) AS VENDA_MAIS_ANTIGA
FROM VENDAS;

SELECT
    categoria,
    COUNT(*) AS qtd_vendas,
    SUM(valor) AS receita_total
FROM VENDAS
GROUP BY categoria
ORDER BY receita_total DESC;


--Exercicio 1

SELECT COUNT(PRODUTO) 
FROM VENDAS 
WHERE VENDEDOR = 'Ana';

--Exercicio 2

SELECT 
SUM(VALOR) AS VENDA_ELETRONICOS 
FROM VENDAS 
WHERE CATEGORIA = 'Eletrônicos';

--EXERCICIO 3

SELECT PRODUTO, VALOR 
FROM VENDAS 
WHERE VALOR BETWEEN 200 AND 1000;

--EXERCICIO 4

SELECT 
VENDEDOR,
COUNT(VENDEDOR),
SUM(VALOR) AS VALOR_TOTAL
FROM VENDAS
GROUP BY VENDEDOR
ORDER BY VALOR_TOTAL DESC;



